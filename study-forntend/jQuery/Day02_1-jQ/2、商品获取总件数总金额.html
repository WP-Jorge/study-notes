<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<script src="jQuery-3.5.1.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<style type="text/css">
		input {
			width: 30px;
		}

		a {
			position: relative;
			text-decoration: none;
			background-color: #CCCCCC;
			top: 2px;
			width: 20px;
			height: 20px;
			display: inline-block;
		}

		li {
			list-style-type: none;
		}
	</style>
	<body>
		全选：<input type="checkbox" class="check-all" />
		<div id="goods">
			<li>
				<input type="checkbox" class="check" />
				单价：<span class="price">19.30</span>元
				数量：<a class="low" href="javascript:void(0);">-</a>
				<input class="num" type="text" value="1" />
				<a class="plus" href="javascript:void(0);">+</a>
				总计：<span class="total-price"></span>元
			</li>
			<li>
				<input type="checkbox" class="check" />
				单价：<span class="price">21.50</span>元
				数量：<a class="low" href="javascript:void(0);">-</a>
				<input class="num" type="text" value="1" />
				<a class="plus" href="javascript:void(0);">+</a>
				总计：<span class="total-price"></span>元
			</li>
			<li>
				<input type="checkbox" class="check" />
				单价：<span class="price">12.60</span>元
				数量：<a class="low" href="javascript:void(0);">-</a>
				<input class="num" type="text" value="1" />
				<a class="plus" href="javascript:void(0);">+</a>
				总计：<span class="total-price"></span>元
			</li>
			<li>
				<input type="checkbox" class="check" />
				单价：<span class="price">99.90</span>元
				数量：<a class="low" href="javascript:void(0);">-</a>
				<input class="num" type="text" value="1" />
				<a class="plus" href="javascript:void(0);">+</a>
				总计：<span class="total-price"></span>元
			</li>
		</div>
		全选：<input type="checkbox" class="check-all" />
		<div class="sum">
			总件数：<span class="goods_sum"></span>
			总金额：<span class="goods_price"></span>
		</div>


		<script type="text/javascript">
			// 每个商品的操作添加初始总金额
			$.each($("li a"), function(i, ele) {
				let p = $(ele).parent().children(".price").html()
				let num = $(ele).parent().children(".num").val()
				let totalPrice = (p * num).toFixed(2) // 使用.toFixed(2) 给数保留两位小数
				$(ele).parent().children(".total-price").html(totalPrice)
			})
			getSum()
			// 点击"-"文本框数量-1
			$("li .low").click(function() {
				let num = $(this).parent().children(".num").val()
				// 如果数量为0时返回，不继续-1
				if (num == 1) {
					return
				}
				num--
				$(this).parent().children(".num").val(num)
			})
			// 点击"+"文本框数量+1
			$("li .plus").click(function() {
				let num = $(this).parent().children(".num").val()
				// 如果数量为0时返回，不继续-1
				num++
				$(this).parent().children(".num").val(num)
				getSum()
			})
			// 点击"+""-"修改文本框同步修改金额
			$("li a").click(function() {
				let p = $(this).parent().children(".price").html()
				let num = $(this).parent().children(".num").val()
				let totalPrice = (p * num).toFixed(2) // 使用.toFixed(2) 给数保留两位小数
				$(this).parent().children(".total-price").html(totalPrice)
				getSum()
			})
			// 直接修改文本框数量同步修改金额
			$("li .num").change(function() {
				let p = $(this).parent().children(".price").html()
				let num = $(this).parent().children(".num").val()
				let totalPrice = (p * num).toFixed(2) // 使用.toFixed(2) 给数保留两位小数
				$(this).parent().children(".total-price").html(totalPrice)
				getSum()
			})
			// 获取总件数总金额
			function getSum(){
				let count = 0
				let money = 0
				$("li .num").each(function(i, e){
					count += parseInt($(e).val())
				})
				$(".goods_sum").text(count)
				
				$("li .total-price").each(function(i, e){
					money = money + parseFloat($(e).text())
				})
				$(".goods_price").text(money.toFixed(2))
			}
			
		</script>
	</body>
</html>
