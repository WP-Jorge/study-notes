<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.boxmusic.mapper.UserMapper">
	<cache-ref namespace="com.example.boxmusic.mapper.UserMapper"/>
	<cache-ref namespace="com.example.boxmusic.mapper.RoleMapper"/>
	
	<!-- 通用查询映射结果 -->
	<resultMap id="BaseResultMap" type="com.example.boxmusic.pojo.entity.User">
		<id column="user_id" property="userId"/>
		<result column="username" property="username"/>
		<result column="password" property="password"/>
		<result column="sex" property="sex"/>
		<result column="age" property="age"/>
		<result column="tel" property="tel"/>
		<result column="email" property="email"/>
		<result column="user_pic" property="userPic"/>
		<result column="status" property="status"/>
		<result column="create_time" property="createTime"/>
		<result column="update_time" property="updateTime"/>
		<result column="deleted" property="deleted"/>
	</resultMap>
	
	<select id="getUserWithUsername" resultType="com.example.boxmusic.pojo.entity.User">
		select *
		from user
		where username = #{username}
	</select>
	
	<insert id="addUser">
		insert into user
			(username, password, sex, age, tel, email, user_pic, status)
		values (#{username}, #{password}, #{sex}, #{age}, #{tel}, #{email}, #{userPic}, #{status})
	</insert>
	
	<select id="getUserInfoWithUsername" resultType="com.example.boxmusic.pojo.vo.UserVO">
		select *
		from user
		where username = #{username}
	</select>
	<select id="getAllUsersPage" resultType="com.example.boxmusic.pojo.vo.UserVO">
		select *
		from user
	</select>
	<select id="getUsersByUsernamePage" resultType="com.example.boxmusic.pojo.vo.UserVO">
		select *
		from user
		where username like concat('%', #{username}, '%')
	</select>
</mapper>
